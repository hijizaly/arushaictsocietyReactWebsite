import{r as i}from"./react.7518b171.js";const A=n=>{const[,g]=i.exports.useReducer(e=>e+1,0),c=i.exports.useRef(null),{replace:f,append:D}=n,d=f?f(n.format(n.value)):n.format(n.value),h=i.exports.useRef(!1),C=e=>{const r=e.target.value;c.current=[r,e.target,r.length>d.length,h.current,d===n.format(r)],g()};return i.exports.useLayoutEffect(()=>{if(c.current==null)return;let[e,r,s,w,v]=c.current;c.current=null;const k=w&&v,y=e.slice(r.selectionStart).search(n.accept||/\d/g),L=y!==-1?y:0,o=t=>(t.match(n.accept||/\d/g)||[]).join(""),x=o(e.substr(0,r.selectionStart)),E=t=>{let a=0,u=0;for(let m=0;m!==x.length;++m){let R=t.indexOf(x[m],a)+1,S=o(t).indexOf(x[m],u)+1;S-u>1&&(R=a,S=u),u=Math.max(S,u),a=Math.max(a,R)}return a};if(n.mask===!0&&s&&!v){let t=E(e);const a=o(e.substr(t))[0];t=e.indexOf(a,t),e=`${e.substr(0,t)}${e.substr(t+1)}`}let l=n.format(e);D!=null&&r.selectionStart===e.length&&!v&&(s?l=D(l):o(l.slice(-1))===""&&(l=l.slice(0,-1)));const O=f?f(l):l;return d===O?g():n.onChange(O),()=>{let t=E(l);if(n.mask!=null&&(s||w&&!k))for(;l[t]&&o(l[t])==="";)t+=1;r.selectionStart=r.selectionEnd=t+(k?1+L:0)}}),i.exports.useEffect(()=>{const e=s=>{s.code==="Delete"&&(h.current=!0)},r=s=>{s.code==="Delete"&&(h.current=!1)};return document.addEventListener("keydown",e),document.addEventListener("keyup",r),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",r)}},[]),{value:c.current!=null?c.current[0]:d,onChange:C}};export{A as u};
